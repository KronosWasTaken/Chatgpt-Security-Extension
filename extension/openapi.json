{"openapi":"3.1.0","info":{"title":"AI Compliance Platform","description":"AI Compliance Platform Backend API","version":"0.1.0"},"paths":{"/api/v1/auth/login":{"post":{"tags":["authentication"],"summary":"Login","description":"Authenticate user and return JWT tokens.","operationId":"login_api_v1_auth_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/refresh":{"post":{"tags":["authentication"],"summary":"Refresh Token","description":"Refresh access token using refresh token.","operationId":"refresh_token_api_v1_auth_refresh_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/logout":{"post":{"tags":["authentication"],"summary":"Logout","description":"Logout user (client-side token removal).","operationId":"logout_api_v1_auth_logout_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/msp/summary":{"get":{"tags":["msp"],"summary":"Get Msp Summary","description":"Get MSP summary and statistics.","operationId":"get_msp_summary_api_v1_msp_summary_get","parameters":[{"name":"func","in":"query","required":true,"schema":{"title":"Func"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MSPSummaryResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/msp/clients":{"get":{"tags":["msp"],"summary":"Get Msp Clients","description":"Get all clients managed by the MSP.","operationId":"get_msp_clients_api_v1_msp_clients_get","parameters":[{"name":"func","in":"query","required":true,"schema":{"title":"Func"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ClientSummaryResponse"},"title":"Response Get Msp Clients Api V1 Msp Clients Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/msp/reports/summary":{"get":{"tags":["msp"],"summary":"Get Msp Reports Summary","description":"Get MSP-level reporting summary.","operationId":"get_msp_reports_summary_api_v1_msp_reports_summary_get","parameters":[{"name":"func","in":"query","required":true,"schema":{"title":"Func"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Msp Reports Summary Api V1 Msp Reports Summary Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/clients/":{"get":{"tags":["clients"],"summary":"Get Clients","description":"Get clients accessible to the current user.","operationId":"get_clients_api_v1_clients__get","parameters":[{"name":"func","in":"query","required":true,"schema":{"title":"Func"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ClientResponse"},"title":"Response Get Clients Api V1 Clients  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/users/":{"get":{"tags":["users"],"summary":"Get Users","description":"Get users accessible to the current user.","operationId":"get_users_api_v1_users__get","parameters":[{"name":"func","in":"query","required":true,"schema":{"title":"Func"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserResponse"},"title":"Response Get Users Api V1 Users  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/policies/":{"get":{"tags":["policies"],"summary":"Get Policies","description":"Get policies for the current client.","operationId":"get_policies_api_v1_policies__get","parameters":[{"name":"func","in":"query","required":true,"schema":{"title":"Func"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PolicyResponse"},"title":"Response Get Policies Api V1 Policies  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/ai-services/":{"get":{"tags":["ai-services"],"summary":"Get Ai Services","description":"Get AI services registry.","operationId":"get_ai_services_api_v1_ai_services__get","parameters":[{"name":"func","in":"query","required":true,"schema":{"title":"Func"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/AIServiceResponse"},"title":"Response Get Ai Services Api V1 Ai Services  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/analyze/prompt":{"post":{"tags":["analyze"],"summary":"Analyze Prompt","description":"Analyze a prompt for PHI/PII and compliance violations.\n\nThis is the core endpoint that:\n1. Detects PHI/PII patterns using regex, keywords, and ML\n2. Calculates risk score based on detected patterns\n3. Determines enforcement action based on client policies\n4. Logs the analysis for audit purposes","operationId":"analyze_prompt_api_v1_analyze_prompt_post","parameters":[{"name":"func","in":"query","required":true,"schema":{"title":"Func"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptAnalysisRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptAnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/analyze/ai-services":{"get":{"tags":["analyze"],"summary":"Get Approved Ai Services","description":"Get approved AI services for the current client.\n\nReturns the list of AI services that are approved for use\nby the current client, along with any restrictions.","operationId":"get_approved_ai_services_api_v1_analyze_ai_services_get","parameters":[{"name":"func","in":"query","required":true,"schema":{"title":"Func"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":{"type":"array","items":{"type":"object","additionalProperties":true}},"title":"Response Get Approved Ai Services Api V1 Analyze Ai Services Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/analyze/bulk":{"post":{"tags":["analyze"],"summary":"Analyze Bulk Prompts","description":"Analyze multiple prompts in batch.\n\nUseful for bulk analysis of historical data or batch processing.","operationId":"analyze_bulk_prompts_api_v1_analyze_bulk_post","parameters":[{"name":"func","in":"query","required":true,"schema":{"title":"Func"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PromptAnalysisRequest"},"title":"Prompts"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":{"type":"array","items":{"$ref":"#/components/schemas/PromptAnalysisResponse"}},"title":"Response Analyze Bulk Prompts Api V1 Analyze Bulk Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/audit/":{"get":{"tags":["audit"],"summary":"Get Audit Logs","description":"Get audit logs for the current client.","operationId":"get_audit_logs_api_v1_audit__get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":1000,"minimum":1,"default":50,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","minimum":0,"default":0,"title":"Offset"}},{"name":"start_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Start Date"}},{"name":"end_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"End Date"}},{"name":"func","in":"query","required":true,"schema":{"title":"Func"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/AuditLogResponse"},"title":"Response Get Audit Logs Api V1 Audit  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/reports/compliance":{"get":{"tags":["reports"],"summary":"Get Compliance Report","description":"Generate compliance report for the specified framework and period.","operationId":"get_compliance_report_api_v1_reports_compliance_get","parameters":[{"name":"framework","in":"query","required":true,"schema":{"type":"string","description":"Compliance framework: HIPAA, SOC2, GDPR","title":"Framework"},"description":"Compliance framework: HIPAA, SOC2, GDPR"},{"name":"start_date","in":"query","required":true,"schema":{"type":"string","format":"date-time","description":"Report start date","title":"Start Date"},"description":"Report start date"},{"name":"end_date","in":"query","required":true,"schema":{"type":"string","format":"date-time","description":"Report end date","title":"End Date"},"description":"Report end date"},{"name":"func","in":"query","required":true,"schema":{"title":"Func"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ComplianceReportResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/health":{"get":{"summary":"Health Check","description":"Health check endpoint.","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"AIServiceResponse":{"properties":{"id":{"type":"string","title":"Id"},"name":{"type":"string","title":"Name"},"domain_patterns":{"items":{"type":"string"},"type":"array","title":"Domain Patterns"},"category":{"type":"string","title":"Category"},"risk_level":{"type":"string","title":"Risk Level"},"is_active":{"type":"boolean","title":"Is Active"}},"type":"object","required":["id","name","domain_patterns","category","risk_level","is_active"],"title":"AIServiceResponse","description":"AI service response model."},"AuditLogResponse":{"properties":{"id":{"type":"string","title":"Id"},"user_id":{"type":"string","title":"User Id"},"session_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Session Id"},"ai_service_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Ai Service Id"},"prompt_snippet":{"type":"string","title":"Prompt Snippet"},"enforcement_action":{"type":"string","title":"Enforcement Action"},"risk_score":{"type":"number","title":"Risk Score"},"created_at":{"type":"string","title":"Created At"}},"type":"object","required":["id","user_id","session_id","ai_service_id","prompt_snippet","enforcement_action","risk_score","created_at"],"title":"AuditLogResponse","description":"Audit log response model."},"ClientResponse":{"properties":{"id":{"type":"string","title":"Id"},"name":{"type":"string","title":"Name"},"industry":{"type":"string","title":"Industry"},"company_size":{"type":"string","title":"Company Size"},"status":{"type":"string","title":"Status"},"compliance_requirements":{"items":{"type":"string"},"type":"array","title":"Compliance Requirements"}},"type":"object","required":["id","name","industry","company_size","status","compliance_requirements"],"title":"ClientResponse","description":"Client response model."},"ClientSummaryResponse":{"properties":{"id":{"type":"string","title":"Id"},"name":{"type":"string","title":"Name"},"industry":{"type":"string","title":"Industry"},"company_size":{"type":"string","title":"Company Size"},"status":{"type":"string","title":"Status"},"compliance_requirements":{"items":{"type":"string"},"type":"array","title":"Compliance Requirements"},"created_at":{"type":"string","title":"Created At"}},"type":"object","required":["id","name","industry","company_size","status","compliance_requirements","created_at"],"title":"ClientSummaryResponse","description":"Client summary response model."},"ComplianceReportResponse":{"properties":{"client_id":{"type":"string","title":"Client Id"},"framework":{"type":"string","title":"Framework"},"period_start":{"type":"string","title":"Period Start"},"period_end":{"type":"string","title":"Period End"},"total_prompts":{"type":"integer","title":"Total Prompts"},"violations_count":{"type":"integer","title":"Violations Count"},"compliance_score":{"type":"number","title":"Compliance Score"},"generated_at":{"type":"string","title":"Generated At"}},"type":"object","required":["client_id","framework","period_start","period_end","total_prompts","violations_count","compliance_score","generated_at"],"title":"ComplianceReportResponse","description":"Compliance report response model."},"DetectionResult":{"properties":{"type":{"type":"string","title":"Type","description":"Detection type: regex, keyword, ml_model"},"pattern_name":{"type":"string","title":"Pattern Name","description":"Name of the detected pattern"},"matches":{"type":"integer","title":"Matches","description":"Number of matches found"},"severity":{"type":"string","title":"Severity","description":"Severity level: low, medium, high, critical"},"framework":{"type":"string","title":"Framework","description":"Compliance framework: HIPAA, Financial, etc."},"confidence":{"type":"number","maximum":1.0,"minimum":0.0,"title":"Confidence","description":"Detection confidence score"}},"type":"object","required":["type","pattern_name","matches","severity","framework","confidence"],"title":"DetectionResult","description":"Individual detection result."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"LoginRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","title":"Password"}},"type":"object","required":["email","password"],"title":"LoginRequest","description":"Login request model."},"LoginResponse":{"properties":{"access_token":{"type":"string","title":"Access Token"},"refresh_token":{"type":"string","title":"Refresh Token"},"token_type":{"type":"string","title":"Token Type","default":"bearer"},"expires_in":{"type":"integer","title":"Expires In"}},"type":"object","required":["access_token","refresh_token","expires_in"],"title":"LoginResponse","description":"Login response model."},"MSPResponse":{"properties":{"id":{"type":"string","title":"Id"},"name":{"type":"string","title":"Name"},"business_type":{"type":"string","title":"Business Type"},"subscription_tier":{"type":"string","title":"Subscription Tier"},"status":{"type":"string","title":"Status"},"created_at":{"type":"string","title":"Created At"}},"type":"object","required":["id","name","business_type","subscription_tier","status","created_at"],"title":"MSPResponse","description":"MSP response model."},"MSPSummaryResponse":{"properties":{"msp":{"$ref":"#/components/schemas/MSPResponse"},"total_clients":{"type":"integer","title":"Total Clients"},"active_clients":{"type":"integer","title":"Active Clients"},"total_users":{"type":"integer","title":"Total Users"},"recent_activity":{"additionalProperties":true,"type":"object","title":"Recent Activity"}},"type":"object","required":["msp","total_clients","active_clients","total_users","recent_activity"],"title":"MSPSummaryResponse","description":"MSP summary response model."},"PolicyResponse":{"properties":{"id":{"type":"string","title":"Id"},"name":{"type":"string","title":"Name"},"description":{"type":"string","title":"Description"},"enforcement_level":{"type":"string","title":"Enforcement Level"},"status":{"type":"string","title":"Status"},"created_at":{"type":"string","title":"Created At"}},"type":"object","required":["id","name","description","enforcement_level","status","created_at"],"title":"PolicyResponse","description":"Policy response model."},"PromptAnalysisRequest":{"properties":{"prompt":{"type":"string","maxLength":10000,"minLength":1,"title":"Prompt","description":"Text prompt to analyze"},"url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Url","description":"URL where prompt was entered"},"session_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Session Id","description":"Browser session ID"},"user_agent":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Agent","description":"User agent string"},"ip_address":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Ip Address","description":"Client IP address"},"browser_fingerprint":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Browser Fingerprint","description":"Browser fingerprint"}},"type":"object","required":["prompt"],"title":"PromptAnalysisRequest","description":"Request model for prompt analysis."},"PromptAnalysisResponse":{"properties":{"prompt_hash":{"type":"string","title":"Prompt Hash","description":"SHA-256 hash of the prompt"},"detections":{"items":{"$ref":"#/components/schemas/DetectionResult"},"type":"array","title":"Detections","description":"Detected patterns"},"risk_score":{"type":"number","maximum":1.0,"minimum":0.0,"title":"Risk Score","description":"Overall risk score"},"enforcement_action":{"type":"string","title":"Enforcement Action","description":"Enforcement action: allowed, warned, blocked, flagged"},"confidence_score":{"type":"number","maximum":1.0,"minimum":0.0,"title":"Confidence Score","description":"Overall confidence score"},"processing_time_ms":{"type":"integer","title":"Processing Time Ms","description":"Analysis processing time in milliseconds"},"analyzed_at":{"type":"string","title":"Analyzed At","description":"ISO timestamp of analysis"}},"type":"object","required":["prompt_hash","risk_score","enforcement_action","confidence_score","processing_time_ms","analyzed_at"],"title":"PromptAnalysisResponse","description":"Response model for prompt analysis."},"RefreshTokenRequest":{"properties":{"refresh_token":{"type":"string","title":"Refresh Token"}},"type":"object","required":["refresh_token"],"title":"RefreshTokenRequest","description":"Refresh token request model."},"UserResponse":{"properties":{"id":{"type":"string","title":"Id"},"email":{"type":"string","title":"Email"},"first_name":{"type":"string","title":"First Name"},"last_name":{"type":"string","title":"Last Name"},"role":{"type":"string","title":"Role"},"is_active":{"type":"boolean","title":"Is Active"}},"type":"object","required":["id","email","first_name","last_name","role","is_active"],"title":"UserResponse","description":"User response model."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}